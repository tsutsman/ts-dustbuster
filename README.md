# ts-dustbuster

`ts-dustbuster` — кросплатформений інструмент очищення кешів і тимчасових файлів із CLI та простим веб-інтерфейсом. Скрипт працює під керуванням Node.js і постачається з обгортками для Linux, Windows та macOS. Для англомовної версії документації перегляньте [README.en.md](README.en.md).

## Основні можливості

- очищення стандартних тимчасових директорій ОС і популярних кешів (браузери, менеджери пакетів);
- dry-run, підсумкова статистика, інтерактивний попередній перегляд перед видаленням;
- підтримка конфігурацій і пресетів у форматі JSON/YAML із наслідуванням та каталогами конфігів;
- паралельне виконання з обмеженням `--concurrency` і веденням логів у файл;
- простий веб-інтерфейс для запуску очищення з браузера.

## Запуск

Для роботи потрібен Node.js версії 16 або новішої.

### Linux

```bash
./cleaner.sh
```

### Windows

```cmd
cleaner.cmd
```

Скрипт встановлює кодову сторінку 65001 (UTF-8) для коректного виведення кирилиці й у разі потреби пропонує встановити Node.js. Прапорець `--deep` додає глибоке очищення системних директорій (`Prefetch`, `SoftwareDistribution\\Download`, `System32\\LogFiles`).

### macOS

```bash
./cleaner-macos.sh
```

Обгортка використовує Homebrew (якщо наявний) для встановлення Node.js та додає типові кеші системи.

### Безпосередній виклик Node.js

```bash
node cleaner.js [параметри]
```

## Параметри CLI

- `--dry-run` — показати, що буде видалено, без фактичного очищення.
- `--summary` — вивести підсумок зі статистикою.
- `--parallel` — вмикає паралельне очищення; разом із `--concurrency <n>` обмежує кількість одночасних операцій.
- `--max-age <тривалість>` — видаляти лише файли старші за вказаний вік (наприклад, `12h`, `5d`).
- `--dir <шлях>` — додати користувацьку директорію (прапорець можна повторювати).
- `--exclude <шлях>` — пропустити каталог або файл.
- `--config <файл|каталог>` — застосувати конфігурації (див. нижче).
- `--preset <назва|шлях>` — підключити попередньо підготовлений пресет.
- `--log <файл>` — зберігати журнал виконання.
- `--preview` — попросити підтвердження перед очищенням кожної директорії.

### Особливості режимів

- `node cleaner.js --help` виведе коротку довідку з усіма прапорцями та
  очікуваним форматом аргументів.
- Режим `--preview` вимагає інтерактивного TTY. У CI/cron процесах запит
  підтвердження не з'явиться, а директорія буде пропущена.
- Прапорець `--deep` актуальний лише для Windows і потребує запуску з
  адміністративними правами, інакше додаткове очищення не розпочнеться.
- Якщо вказано `--log`, дані додаються до існуючого файлу журналу — плануйте
  ротацію, щоб уникнути безконтрольного зростання.

## Конфігурації та пресети

Докладний довідник із прикладами JSON/YAML, описом структури пресетів і рекомендаціями для CI/CD розміщено у [docs/configuration.md](docs/configuration.md) (англомовна версія — [docs/configuration.en.md](docs/configuration.en.md)). Коротко:

- відносні шляхи усередині файлів обчислюються відносно місця розташування конфігу;
- списки директорій та виключень об'єднуються у порядку застосування конфігів;
- поле `presets` дозволяє наслідувати готові набори налаштувань і перевизначати потрібні параметри.

## Веб-інтерфейс

```bash
node gui.js
```

Після запуску відкрийте `http://localhost:3000`, натисніть кнопку очищення й очікуйте результат у текстовому журналі. GUI працює локально та не має автентифікації, тому не публікуйте його у відкритих мережах.

## Тести

Юніт-тести можна виконати командою:

```bash
node test.js
```

## Перевірки якості

Запускайте автоматизовані перевірки перед комітами, щоб відповідати вимогам дорожньої карти щодо якості:

- `npm run lint` — перевіряє код ESLint за рекомендаціями Node.js і інтегрованим форматуванням Prettier.
- `npm run format:check` — гарантує відповідність стилю Prettier без зміни файлів.
- `npm run format` — застосовує форматування Prettier, якщо потрібно швидко вирівняти стиль.
- `npm run test:coverage` — запускає юніт-тести під керуванням `nyc` та генерує звіт покриття (текст і LCOV) з порогом 80%.

Husky підключено як pre-commit гак і автоматично запускає `npm run lint` та `npm run format:check` перед створенням коміту.

## Подальші кроки

Оновлена дорожня карта доступна у [ROADMAP.md](ROADMAP.md). Вона описує розвиток CLI, модульності, автоматизації та GUI.
